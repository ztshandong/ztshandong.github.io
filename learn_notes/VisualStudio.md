# vs登录Azure
```sh
https://docs.azure.cn/zh-cn/articles/azure-operations-guide/others/aog-portal-management-qa-vs2015-login

https://docs.azure.cn/zh-cn/articles/azure-operations-guide/others/aog-portal-management-qa-vs2017-login
安装扩展Azure Environment Selector
Tools-Azure Environment Selector
```

# 删除所有空行 
- ^\s*$\n

```sh
快捷键     功能

ctrl+k,c 注释选中行
     ctrl+k,u 取消对选中行的注释

CTRL + SHIFT + B：生成解决方案

CTRL + F7 ：生成编译

CTRL + O ：打开文件

CTRL + SHIFT + O：打开项目

CTRL + SHIFT + C：显示类视图窗口

F4 ：显示属性窗口

SHIFT + F4：显示项目属性窗口

CTRL + SHIFT + E：显示资源视图

F12 ：转到定义

CTRL + F12：转到声明

CTRL + ALT + J：对象浏览

CTRL + ALT + F1：帮助目录

CTRL + F1 ：动态帮助 

F1 ：帮助

SHIFT + F1：当前窗口帮助

CTRL + ALT + F3：帮助-搜索

SHIFT + ALT + ENTER：全屏显示

CTRL + -：向后定位

CTRL + SHIFT + -：向前定位

CTRL + F4：关闭文档窗口

CTRL + PAGE DOWN：光标定位到窗口上方

CTRL + PAGE UP：光标定位到窗口下方

CTRL + F6 ：

CTRL + TAB：下一个文档窗口

CTRL + SHIFT + F6 ：

CTRL + SHIFT + TAB：上一个文档窗口

ALT + F6：下一个面板窗口

CTRL + K, CTRL + L：取消remark

CTRL + K, CTRL + C：注释选择的代码

CTRL + K, CTRL + U：取消对选择代码的注释

CTRL + M, CTRL + O：折叠代码定义

CTRL + M, CTRL + L：展开代码定义

CTRL + DELETE：删除至词尾

CTRL + BACKSPACE：删除至词头

SHIFT + TAB：取消制表符

CTRL + U：转小写

CTRL + SHIFT + U：转大写

CTRL + SHIFT + END：选择至文档末尾

CTRL + SHIFT + HOME：选择至文档末尾开始

SHIFT + END：选择至行尾

SHIFT + HOME：选择至行开始处

SHIFT + ALT + END：垂直选择到最后尾

SHIFT + ALT + HOME：垂直选择到最前面

CTRL + A：全选

CTRL + W：选择当前单词

CTRL + SHIFT + PAGE UP：选择至本页前面

CTRL + SHIFT + PAGE DOWN：选择至本页后面

CTRL + END：文档定位到最后

CTRL + HOME：文档定位到最前

CTRL + G：转到…

CTRL + K, CTRL + P：上一个标签

CTRL + K, CTRL + N：下一个标签

ALT + F10：调试-ApplyCodeChanges

CTRL + ALT+ Break：停止调试

CTRL + SHIFT + F9 ：取消所有断点

CTRL + F9：允许中断

CTRL + SHIFT + F5：调试-重新开始

F5：运行调试

CTRL + F5：运行不调试

F10：跨过程序执行

F11：单步逐句执行

CTRL + J：列出成员 

CTRL + PAGE DOWN：下一个视图

CTRL + B：格式-粗体

CTRL + SHIFT + T：格式-文字缩进 

 

调试快捷键

 

F6： 生成解决方案

Ctrl+F6： 生成当前项目

F7： 查看代码

Shift+F7： 查看窗体设计器

F5： 启动调试

Ctrl+F5： 开始执行(不调试)

Shift+F5： 停止调试

Ctrl+Shift+F5： 重启调试

F9： 切换断点

Ctrl+F9： 启用/停止断点

Ctrl+Shift+F9： 删除全部断点

F10： 逐过程

Ctrl+F10： 运行到光标处

F11： 逐语句

 

 

编辑快捷键

 

Shift+Alt+Enter： 切换全屏编辑

Ctrl+B,T / Ctrl+K,K： 切换书签开关

Ctrl+B,N / Ctrl+K,N： 移动到下一书签

Ctrl+B,P： 移动到上一书签

Ctrl+B,C： 清除全部标签

Ctrl+I： 渐进式搜索

Ctrl+Shift+I： 反向渐进式搜索

Ctrl+F： 查找

Ctrl+Shift+F： 在文件中查找

F3： 查找下一个

Shift+F3： 查找上一个

Ctrl+H： 替换

Ctrl+Shift+H： 在文件中替换

Alt+F12： 查找符号(列出所有查找结果)

Ctrl+Shift+V： 剪贴板循环

Ctrl+左右箭头键： 一次可以移动一个单词

Ctrl+上下箭头键： 滚动代码屏幕，但不移动光标位置。

Ctrl+Shift+L： 删除当前行

Ctrl+M,M： 隐藏或展开当前嵌套的折叠状态

Ctrl+M,L： 将所有过程设置为相同的隐藏或展开状态

Ctrl+M,P： 停止大纲显示

Ctrl+E,S： 查看空白

Ctrl+E,W： 自动换行

Ctrl+G： 转到指定行

Shift+Alt+箭头键： 选择矩形文本

Alt+鼠标左按钮： 选择矩形文本

Ctrl+Shift+U： 全部变为大写

Ctrl+U： 全部变为小写

 

代码快捷键

 

Ctrl+J / Ctrl+K,L： 列出成员

Ctrl+Shift+空格键 / Ctrl+K,P： 参数信息

Ctrl+K,I： 快速信息

Ctrl+E,C / Ctrl+K,C： 注释选定内容

Ctrl+E,U / Ctrl+K,U： 取消选定注释内容

Ctrl+K,M： 生成方法存根

Ctrl+K,X： 插入代码段

Ctrl+K,S： 插入外侧代码

F12： 转到所调用过程或变量的定义

 

窗口快捷键

 

Ctrl+W,W： 浏览器窗口

Ctrl+W,S： 解决方案管理器

Ctrl+W,C： 类视图

Ctrl+W,E： 错误列表

Ctrl+W,O： 输出视图

Ctrl+W,P： 属性窗口

Ctrl+W,T： 任务列表

Ctrl+W,X： 工具箱

Ctrl+W,B： 书签窗口

Ctrl+W,U： 文档大纲

Ctrl+D,B： 断点窗口

Ctrl+D,I： 即时窗口

Ctrl+Tab： 活动窗体切换

Ctrl+Shift+N： 新建项目

Ctrl+Shift+O： 打开项目

Ctrl+Shift+S： 全部保存

Shift+Alt+C： 新建类

Ctrl+Shift+A： 新建项

 

 

VS2005的隐藏快捷键 

Ctrl+Space：直接完成类或函数（本来这个并不算隐藏的快捷键，但是因为中文输入法抢占这个快捷键，所以。。。，替代的快捷键是Alt+Right）

Shift+Delete：整行删除，并且将这一行放到剪贴板（这时候不能选中一段内容）

Shift+Insert：粘贴，有点匪夷所思，Ctrl+V就可以了，大概是为了和Shift+Delete对应吧

Ctrl+Up，Ctrl+Down：滚动编辑器，但尽量不移动光标，光标保证在可见范围内

Ctrl+BackSpace，Ctrl+Delete：整词删除，有的时候很有用

Ctrl+Left，Ctrl+Right：按整词移动光标（不算隐藏，和前面几条加起来就是Ctrl光标控制套件了）

Alt+Shift+F10：打开执行改名，实现接口和抽象类的小窗口（还可以用Ctrl+.，不过有的中文输入法用到这个）

Shift+F9：调试是打开QuickWatch，内容是当前光标所在处的内容

F12：转跳到定义，很有用的快捷键

Shift+F12：查找所有引用

Ctrl+F10=F5：开始Debug

Ctrl+F6：循环察看代码窗口，有点Ctrl+Tab的感觉

Ctrl+F3：查找当前光标选中的内容，可以和F3配合使用

Ctrl+F2：将焦点转移到类的下拉框上

Alt+F7=Ctrl+Tab

Alt+F11：新开VS2005并编辑宏

Alt+F12：查找=Ctrl+F

```

# [向导项目模版](https://msdn.microsoft.com/zh-cn/library/ms185301.aspx)
```c#
一.创建模版项目
1.创建一个 C# 项目模板项目 (在 Visual Studio 中，文件 / 新建 / 项目 / Visual C# / 可扩展性 / C# 项目模板)。 将其命名MyProjectTemplate。
2.添加一个新的 VSIX 项目 (文件 / 新建 / 项目 / Visual C# / 可扩展性 / VSIX 项目) 项目模板项目的同一个解决方案中 (在解决方案资源管理器，选择解决方案节点，右键单击，并选择添加 / 新项目)。 将其命名MyProjectWizard。
3.将 VSIX 项目设置为启动项目。 在解决方案资源管理器，选择解决方案节点，右键单击，并选择设为启动项目。
4.将模板项目添加为 VSIX 项目的资产。
Add the template project as an asset of the VSIX project.
 在解决方案资源管理器，在 VSIX 项目节点下，查找source.extension.vsixmanifest文件。 双击它以在清单编辑器中打开它。
5.在清单编辑器中，选择资产窗口左侧的选项卡。
6.在资产选项卡上，选择新建。 在添加新资产窗口中的，为类型字段中，选择Microsoft.VisualStudio.ProjectTemplate。 在源字段中，选择当前解决方案中的项目。 在项目字段中，选择MyProjectTemplate。 然后单击“确定” 。
二.创建向导项目
1.在解决方案资源管理器，选择 VSIX 项目节点。 下面的解决方案资源管理器中，您应该看到属性窗口。 如果不这样做，请选择视图 / 属性窗口，或按F4。 在属性窗口中，选择以下字段写入true:
IncludeAssemblyInVSIXContainer

IncludeDebugSymbolsInVSIXContainer

IncludeDebugSymbolsInLocalVSIXDeployment

2.将程序集作为资产添加到 VSIX 项目。
Add the assembly as an asset to the VSIX project.
 打开 source.extension.vsixmanifest 文件，然后选择资产选项卡。 在添加新资产窗口中，为类型选择Microsoft.VisualStudio.Assembly，为源选择当前解决方案中的项目，以及用于项目选择MyTemplateWizard。

3.添加对 VSIX 项目的以下引用。 (在解决方案资源管理器，在 VSIX 项目节点，请选择引用，右键单击，然后选择添加引用。)在添加引用对话框，请在Framework选项卡上，查找System.Windows 窗体程序集，然后选择它。 现在，请选择扩展选项卡。 查找EnvDTE程序集，然后选择它。 其中还有Microsoft.VisualStudio.TemplateWizardInterface程序集，然后选择它。 单击“确定”。

4.将向导实现的类添加到 VSIX 项目。 (在解决方案资源管理器，右键单击 VSIX 项目节点并选择添加，然后新项，然后类。)将类命名WizardImplementation。
WizardImplementation类包含的每个成员的方法实现IWizard。 在此示例中，只有RunStarted方法执行一项任务。 所有其他方法不执行任何操作或返回true。

RunStarted方法接受四个参数︰

对象参数可强制转换为根_DTE对象，以使您可以自定义项目。

一个字典<TKey, TValue>参数，其中包含模板中的所有预定义参数的集合。</TKey, TValue> 有关模板参数的详细信息，请参阅模板参数。

一个WizardRunKind参数，其中包含有关使用哪种模板的信息。

对象数组，其中包含一组参数传递给向导由 Visual Studio。

此示例将参数值添加到窗体用户输入来自字典<TKey, TValue>参数。</TKey, TValue> 每个实例$custommessage$项目中的参数将替换为用户输入的文本。 您必须将以下程序集添加到您的项目中：

5.WizardImplementationClass.cs文件替换为以下代码︰

using System;
using System.Collections.Generic;
using Microsoft.VisualStudio.TemplateWizard;
using System.Windows.Forms;
using EnvDTE;

namespace MyProjectWizard
{
    public class WizardImplementation : IWizard
    {
        private UserInputForm inputForm;
        private string customMessage;
        private string customMessage2;

        // This method is called before opening any item that   
        // has the OpenInEditor attribute.  
        public void BeforeOpeningFile(ProjectItem projectItem)
        {
        }

        public void ProjectFinishedGenerating(Project project)
        {
        }

        // This method is only called for item templates,  
        // not for project templates.  
        public void ProjectItemFinishedGenerating(ProjectItem
            projectItem)
        {
        }

        // This method is called after the project is created.  
        public void RunFinished()
        {
        }

        public void RunStarted(object automationObject,
            Dictionary<string, string> replacementsDictionary,
            WizardRunKind runKind, object[] customParams)
        {
            try
            {
                // Display a form to the user. The form collects   
                // input for the custom message.  
                inputForm = new UserInputForm();
                inputForm.ShowDialog();

                customMessage = UserInputForm.CustomMessage;
                customMessage2 = UserInputForm.CustomMessage2;

                // Add custom parameters.  
                replacementsDictionary.Add("$custommessage$",
                    customMessage);

                replacementsDictionary.Add("$custommessage2$",
    customMessage2);
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
            }
        }

        // This method is only called for item templates,  
        // not for project templates.  
        public bool ShouldAddProjectItem(string filePath)
        {
            return true;
        }
    }


    public partial class UserInputForm : Form
    {
        private static string customMessage;
        private static string customMessage2;
        private TextBox textBox1;
        private TextBox textBox2;
        private Button button1;

        public UserInputForm()
        {
            this.Size = new System.Drawing.Size(200, 300);

            button1 = new Button();
            button1.Text = "OK";
            button1.Location = new System.Drawing.Point(90, 25);
            button1.Size = new System.Drawing.Size(50, 25);
            button1.Click += button1_Click;
            this.Controls.Add(button1);

            textBox1 = new TextBox();
            textBox1.Location = new System.Drawing.Point(10, 25);
            textBox1.Size = new System.Drawing.Size(70, 20);
            this.Controls.Add(textBox1);

            textBox2 = new TextBox();
            textBox2.Location = new System.Drawing.Point(10, 50);
            textBox2.Size = new System.Drawing.Size(70, 20);
            this.Controls.Add(textBox2);
        }
        public static string CustomMessage
        {
            get
            {
                return customMessage;
            }
            set
            {
                customMessage = value;
            }
        }

        public static string CustomMessage2
        {
            get
            {
                return customMessage2;
            }
            set
            {
                customMessage2 = value;
            }
        }
        private void button1_Click(object sender, EventArgs e)
        {
            customMessage = textBox1.Text;
            customMessage2 = textBox2.Text;
            this.Close();
        }
    }
}

三.签名
1.在解决方案资源管理器，选择该 VSIX 项目，右键单击，然后选择项目属性。
2.在项目属性窗口中，选择签名选项卡。 在签名选项卡上，选中为程序集签名。 在选择强名称密钥文件字段中，选择新建; 。 在创建强名称密钥窗口，请在密钥文件名称字段中，键入key.snk。 取消选中保护密钥文件使用的密码字段。
3.在解决方案资源管理器、 选择 VSIX 项目并找到属性窗口。设置复制生成的输出到输出目录字段拖至true。 这允许要复制到输出目录中，重新生成解决方案时的程序集。 它仍包含在.vsix 文件。 您需要查看该程序集来找出其签名密钥。重新生成解决方案。
4.将 key.snk 文件粘贴到输出目录 (>\MyProjectTemplate/MyProjectWizard\bin\Debug\MyProjectWizard.dll)。 粘贴的 key.snk 文件。 （这不是绝对必要，但它将使以下步骤更容易。）
5.查找sn.exe签名工具。 例如，在 Windows 10 64 位操作系统，典型路径将是以下︰
C:\Program Files (x86) \Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6.1 Tools
6.从 key.snk 文件中提取公钥。 在命令窗口中，键入
>sn.exe -p key.snk outfile.key
7.从 outfile 中获取的公钥令牌︰
>sn.exe-t outfile.key
可以看到公钥标记是xxx，记下该值
8.将对自定义向导的引用添加到项目模板的.vstemplate 文件。 在解决方案资源管理器，找到名为 MyProjectTemplate.vstemplate，该文件并将其打开。 在</TemplateContent>下面添加以下部分︰
<WizardExtension>  
    <Assembly>MyProjectWizard, Version=1.0.0.0, Culture=Neutral, PublicKeyToken=上一步显示的公钥值</Assembly>  
    <FullClassName>MyProjectWizard.WizardImplementation</FullClassName>  
</WizardExtension>  

四.添加自定义参数
1.在解决方案资源管理器，转到MyProjectTemplate项目，然后打开Class1.cs修改为
using System;
using System.Collections.Generic;  
$if$ ($targetframeworkversion$ >= 3.5)using System.Linq;  
$endif$using System.Text;

namespace $safeprojectname$  
{  
    public class $custommessage2$
{
    static void Main(string[] args)
    {
        Console.WriteLine("$custommessage2$");
        Console.WriteLine("$custommessage$");
    }
}
}

2.将Class1.cs重命名为$custommessage2$.cs
3.将MyProjectTemplate.vstemplate中Class1改为$custommessage2$
4.将ProjectTemplate.csproj中Class1改为$custommessage2$

```

# 多项目模版
```c#
比如有三个项目，vs2017导出项目模板，分别解压到三个文件夹下。然后复制一个MyTemplate.vstemplate出来修改，要用vs打开，不要用记事本

<?xml version="1.0"?>
<VSTemplate Version="3.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="ProjectGroup">
  <TemplateData>
    <Name>myTmp</Name>
    <Description>测试</Description>
    <ProjectType>CSharp</ProjectType>
    <ProjectSubType></ProjectSubType>
    <SortOrder>1000</SortOrder>
    <CreateNewFolder>true</CreateNewFolder>
    <DefaultName>MultiTest</DefaultName>
    <ProvideDefaultName>true</ProvideDefaultName>
    <LocationField>Enabled</LocationField>
    <EnableLocationBrowseButton>true</EnableLocationBrowseButton>
  </TemplateData>
  <TemplateContent>
    <ProjectCollection>
      <SolutionFolder Name="folder">
        <ProjectTemplateLink ProjectName="ClassLibrary2">ProjTMPClassLibrary2\MyTemplate.vstemplate</ProjectTemplateLink>
      </SolutionFolder>
      <ProjectTemplateLink ProjectName="ClassLibrary1">ProjTMPClassLibrary1\MyTemplate.vstemplate</ProjectTemplateLink>
      <ProjectTemplateLink ProjectName="Core1">ProjTMPCore1\MyTemplate.vstemplate</ProjectTemplateLink>
    </ProjectCollection>
  </TemplateContent>
</VSTemplate>


ProjectName="$safeprojectname$"就是玩花了，源码要改命名空间，每个项目都要改，比较麻烦

NETCore的项目中 .csproj文件不包括源文件，所以要手动添加
  <ItemGroup>
    <ProjectReference Include="..\ClassLibrary1\ClassLibrary1.csproj" />
    <Compile Include="Program.cs" />
  </ItemGroup>

发送到zip文件夹

新建VSIX工程
source.extension.vsixmanifest
Assets添加zip包






项模板
$username$
$time$ 
$clrversion$
namespace $rootnamespace$
public class $safeitemname$
```